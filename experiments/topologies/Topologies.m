AppendTo[$Path, "src/Packages"];
ClearAll[ERConnectivity, BAConnectivity, WSConnectivity, SaveTopology];
ERConnectivity[n_Integer, p_?NumericQ, seed_: Automatic] := Module[{cm}, If[NumericQ[seed], SeedRandom[seed]]; cm = Table[If[i == j, 0, Boole[RandomReal[] < p]], {i, 1, n}, {j, 1, n}]; <|"cm" -> cm, "meta" -> <|"type" -> "ER", "n" -> n, "p" -> p, "seed" -> seed|>|>];
BAConnectivity[n_Integer, m_Integer: 2, seed_: Automatic] := Module[{adj, deg, edges, target}, If[NumericQ[seed], SeedRandom[seed]]; adj = ConstantArray[0, {n, n}]; Do[If[i != j, adj[[i, j]] = 1; adj[[j, i]] = 1], {i, 1, m}, {j, 1, m}]; deg = Total[adj]; Do[edges = {}; While[Length[edges] < m && v > 1, target = RandomChoice[deg[[1 ;; v - 1]] -> Range[v - 1]]; If[target != v && ! MemberQ[edges, target], AppendTo[edges, target]]]; Do[adj[[v, t]] = 1; adj[[t, v]] = 1, {t, edges}]; deg = Total[adj], {v, m + 1, n}]; Do[adj[[i, i]] = 0, {i, 1, n}]; <|"cm" -> adj, "meta" -> <|"type" -> "BA", "n" -> n, "m" -> m, "seed" -> seed|>|>];
WSConnectivity[n_Integer, k_Integer: 2, beta_?NumericQ: 0.1, seed_: Automatic] := Module[{adj, half, edges, rewire}, If[NumericQ[seed], SeedRandom[seed]]; adj = ConstantArray[0, {n, n}]; half = Floor[k/2]; Do[Do[adj[[i, Mod[i + s - 1, n] + 1]] = 1; adj[[Mod[i + s - 1, n] + 1, i]] = 1, {s, 1, half}], {i, 1, n}]; edges = Select[Flatten[Table[{i, j}, {i, 1, n}, {j, i + 1, n}], 1], adj[[#[[1]], #[[2]]]] == 1 &]; rewire = Function[{i, j}, If[RandomReal[] < beta, Module[{newj}, newj = RandomChoice[Complement[Range[n], {i}]]; adj[[i, j]] = 0; adj[[j, i]] = 0; adj[[i, newj]] = 1; adj[[newj, i]] = 1]]]; Scan[rewire @@ # &, edges]; Do[adj[[i, i]] = 0, {i, 1, n}]; <|"cm" -> adj, "meta" -> <|"type" -> "WS", "n" -> n, "k" -> k, "beta" -> beta, "seed" -> seed|>|>];
SaveTopology[cm_, meta_Association, basePath_: "data/topologies"] := Module[{dir}, dir = basePath; If[! DirectoryQ[dir], CreateDirectory[dir, CreateIntermediateDirectories -> True]]; Export[FileNameJoin[{dir, meta["type"] <> "_cm_n" <> ToString[meta["n"]] <> ".csv"}], cm, "CSV"]; Export[FileNameJoin[{dir, meta["type"] <> "_meta_n" <> ToString[meta["n"]] <> ".json"}], meta, "JSON"]; <|"Path" -> dir|>];